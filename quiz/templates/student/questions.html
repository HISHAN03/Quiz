<!DOCTYPE html>
<html>
<head>
    <title>Questions</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body>
    <h1>Questions for Quiz {{ quiz_id }}</h1>
    <form method="post" id="quiz-form">
        {% csrf_token %}
        <input type="hidden" id="score" name="score" value="0">
        {% for question_id, question, op1, op2, op3, op4, ans in questions_quiz %}
            <div>
                <p>{{ question }}</p>
                <label><input type="radio" name="answer_{{ question_id }}" value="{{ op1 }}"> {{ op1 }}</label><br>
                <label><input type="radio" name="answer_{{ question_id }}" value="{{ op2 }}"> {{ op2 }}</label><br>
                <label><input type="radio" name="answer_{{ question_id }}" value="{{ op3 }}"> {{ op3 }}</label><br>
                <label><input type="radio" name="answer_{{ question_id }}" value="{{ op4 }}"> {{ op4 }}</label><br>
                <input type="hidden" class="correct-answer" id="correct_answer_{{ question_id }}" value="{{ ans }}">
            </div>
        {% endfor %}
        <button type="button" id="submit-btn">Submit</button>
    </form>

    <div id="result">
        <h2>Your Score: <span id="score-display">0</span></h2>
    </div>

    <script>
        $(document).ready(function() {
            var score = 0;

            $("#submit-btn").on("click", function() {
                score = 0;
                console.log("Submit button clicked");

                $("[name^=answer_]").each(function() {
                    var questionId = $(this).attr("name").split("_")[1];
                    console.log("Checking question ID:", questionId);

                    var selectedOption = $("input[name=answer_" + questionId + "]:checked").val();
                    console.log("Selected option:", selectedOption);

                    var correctAnswer = $("#correct_answer_" + questionId).val();
                    console.log("Correct answer:", correctAnswer);
                    
                    if (selectedOption === correctAnswer) {
                        score++;
                        console.log("Correct answer! Score:", score);
                        
                    } else {
                        console.log("Incorrect answer.");
                    }
                });

                console.log("Final score:", score);
                $("#score-display").text(score);

                $("#result").show();


            if(score>=4)
            {
                alert('passed')
            }
            else
            {
                alert('failed,try again next time')

            }
                
            });
         




        });
    </script>
</body>
</html>
